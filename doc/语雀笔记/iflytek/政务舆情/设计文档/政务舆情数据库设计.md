# 政务舆情数据库设计

## 1.event_info

### 1.1字段说明

|字段名|类型|备注|
| -----------------| ----------------| -------------------------------------|
|id|String|事件标识|
|callId|String|通话标识|
|typeId|Nullable(String)|事件类型ID|
|eventType|Nullable(String)|事件类型|
|description|Nullable(String)|事件描述|
|dialogue|Nullable(String)|对话描述|
|element|String|事件元素（Json类型的字符串）|
|createTime|DateTime|发生时间（通话时间）冗余字段 便于查询|
|updateTime|DateTime|更新时间（告警用）|
|elementNum|Nullable(String)|描述使用的要素数量|
|emotion|String|情绪|
|content|String|通话内容|
|eventTypeOriginal|Nullable(String)|原始事件类型|

### 1.2SQL

```sql
-- auto-generated definition
create table event_info
(
    id                String comment '事件标识',
    callId            String comment '通话标识',
    typeId            Nullable(String) comment '事件类型ID',
    eventType         Nullable(String) comment '事件类型',
    description       Nullable(String) comment '事件描述',
    dialogue          Nullable(String) comment '对话描述',
    element           String comment '事件元素（Json类型的字符串）',
    createTime        DateTime comment '发生时间（通话时间）冗余字段 便于查询',
    updateTime        DateTime comment '更新时间（告警用）',
    elementNum        Nullable(String) comment '描述使用的要素数量',
    emotion           String comment '情绪',
    content           String comment '通话内容',
    eventTypeOriginal Nullable(String) comment '原始事件类型'
)
    engine = MergeTree ORDER BY id
        SETTINGS index_granularity = 8192;
```

## 2.call_basic_info

### 2.1字段说明

|字段名|类型|备注|
| ---------------| ----------------| ------------|
|id|String|通话标识|
|date|DateTime|通话时间|
|area|Nullable(String)|通话区域|
|dataSource|Nullable(String)|通话数据源|
|linkTel|String|通话号码|
|content|String|对话详情|
|overview|String|对话缩略|
|voiceUri|String|通话音频路径|
|emotion|Nullable(String)|情绪|
|eventType|Nullable(String)||
|rowguid|Nullable(String)||
|flag|String||
|applicationName|Nullable(String)||
|address|Nullable(String)||
|registerName|Nullable(String)||
|reply|Nullable(String)||
|caseTypeName|Nullable(String)|事件类型名称|

### 2.2SQL

```sql
-- auto-generated definition
create table call_basic_info
(
    id              String comment '通话标识',
    date            DateTime comment '通话时间',
    area            Nullable(String) comment '通话区域',
    dataSource      Nullable(String) comment '通话数据源',
    linkTel         String comment '通话号码',
    content         String comment '对话详情',
    overview        String comment '对话缩略',
    voiceUri        String comment '通话音频路径',
    emotion         Nullable(String) comment '情绪',
    eventType       Nullable(String),
    rowguid         Nullable(String),
    flag            String           default 0,
    applicationName Nullable(String),
    address         Nullable(String),
    registerName    Nullable(String),
    reply           Nullable(String),
    caseTypeName    Nullable(String) default '其他' comment '事件类型名称'
)
    engine = MergeTree ORDER BY id
        SETTINGS index_granularity = 8192;


```

## 3.alarm_info

### 3.1字段说明

|字段名|类型|备注|
| -----------| ----------------| --------------------|
|id|String|告警标识（自增主键）|
|ruleId|String|告警规则ID|
|eventTypeId|String|事件类型ID|
|eventId|String|事件标识|
|callId|String|通话标识|
|calldate|DateTime|通话时间|
|eventType|String|事件类型|
|eventDesc|String|事件描述|
|dialogue|String|对话详情|
|createTime|DateTime|告警时间|
|description|Nullable(String)|告警描述|
|dimension|Array(String)|告警维度|

### 3.2SQL

```sql
-- auto-generated definition
create table alarm_info
(
    id          String comment '告警标识（自增主键）',
    ruleId      String comment '告警规则ID',
    eventTypeId String comment '事件类型ID',
    eventId     String comment '事件标识',
    callId      String comment '通话标识',
    calldate    DateTime comment '通话时间',
    eventType   String comment '事件类型',
    eventDesc   String comment '事件描述',
    dialogue    String comment '对话详情',
    createTime  DateTime comment '告警时间',
    description Nullable(String) comment '告警描述',
    dimension   Array(String) comment '告警维度'
)
    engine = MergeTree ORDER BY id
        SETTINGS index_granularity = 8192;
```

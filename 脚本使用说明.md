# 脚本使用说明

## 📋 脚本列表

项目中提供了以下实用脚本：

### 1. `update_nav.py` - 导航更新脚本（Python 版本）⭐ 推荐

**功能**: 自动扫描 `doc` 目录，生成 `_sidebar.md` 和 `_navbar.md`

**特点**:
- ✅ 功能完整，支持多级目录
- ✅ 自动识别目录结构
- ✅ 智能处理文件名和路径
- ✅ 显示详细的扫描信息和统计
- ✅ 支持自定义图标映射

**使用方法**:
```bash
python3 update_nav.py
```

**要求**: Python 3.6+

---

### 2. `update_nav.sh` - 导航更新脚本（Shell 版本）

**功能**: 与 Python 版本功能类似，但使用 Shell 脚本实现

**特点**:
- ✅ 无需 Python 环境
- ✅ 适合简单的目录结构
- ✅ 执行速度快

**使用方法**:
```bash
./update_nav.sh
```

**要求**: Bash Shell

---

### 3. `start.sh` - 本地预览脚本

**功能**: 启动本地开发服务器预览网站

**使用方法**:
```bash
./start.sh
```

访问 http://localhost:3000

---

## 🚀 完整工作流程

### 场景 1: 添加新笔记

```bash
# 1. 创建新的 Markdown 文件
vim doc/烂笔头/Redis相关.md

# 2. 编写内容...

# 3. 自动更新导航（推荐使用 Python 版本）
python3 update_nav.py

# 4. 本地预览
./start.sh

# 5. 检查效果，满意后提交
git add .
git commit -m "添加 Redis 相关笔记"
git push
```

### 场景 2: 添加新的书籍分类

```bash
# 1. 创建新目录
mkdir -p "doc/大数据书籍/Flink实战"

# 2. 添加文章
vim "doc/大数据书籍/Flink实战/01Flink入门.md"

# 3. 自动更新导航
python3 update_nav.py

# 4. 本地预览检查
./start.sh

# 5. 提交
git add .
git commit -m "添加 Flink 实战笔记"
git push
```

### 场景 3: 批量添加文章

```bash
# 1. 批量创建文件
touch "doc/烂笔头/MySQL优化.md"
touch "doc/烂笔头/Nginx配置.md"
touch "doc/烂笔头/Linux命令.md"

# 2. 编写内容...

# 3. 一键更新导航
python3 update_nav.py

# 4. 预览和提交
./start.sh
# 检查后...
git add .
git commit -m "批量添加笔记"
git push
```

---

## 📖 update_nav.py 详细说明

### 工作原理

1. **扫描目录**: 递归扫描 `doc` 目录下的所有文件和文件夹
2. **构建树结构**: 将目录结构转换为树形数据结构
3. **生成侧边栏**: 根据树结构生成 `_sidebar.md`
4. **生成导航栏**: 提取一级分类生成 `_navbar.md`
5. **写入文件**: 保存生成的导航文件

### 配置选项

在 `update_nav.py` 中可以自定义以下配置：

```python
# 排除的目录
EXCLUDE_DIRS = {'.git', '.github', 'node_modules', 'assets', '.DS_Store'}

# 排除的文件
EXCLUDE_FILES = {'README.md', '.DS_Store'}

# 目录图标映射
CATEGORY_ICONS = {
    '大数据书籍': '📚',
    '烂笔头': '📝',
    'Hadoop 权威指南': '🐘',
    '深入理解Kafka核心设计原理': '📨',
    'ClickHouse原理解析与应用实践': '🗄️',
}
```

### 自定义图标

如果你想为新的分类添加图标，编辑 `update_nav.py`：

```python
CATEGORY_ICONS = {
    '大数据书籍': '📚',
    '烂笔头': '📝',
    'Flink实战': '🌊',  # 新增
    'Redis实战': '🔴',  # 新增
}
```

### 输出示例

运行 `python3 update_nav.py` 后的输出：

```
============================================================
🚀 Docsify 导航自动更新脚本
============================================================

📂 扫描 doc 目录结构...

📊 目录结构:
------------------------------------------------------------
📁 大数据书籍/
  📁 Hadoop 权威指南/
    📄 01Hadoop 入门.md
    📄 02Hadoop 分布式文件系统.md
    ...
  📁 深入理解Kafka核心设计原理/
    📄 01初识Kafka.md
    ...
📁 烂笔头/
  📄 ES 相关.md
  📄 经验之谈（采坑日记）.md
------------------------------------------------------------

📊 统计: 共 5 个目录, 24 个文件

📝 开始更新侧边栏...
✅ 侧边栏已更新: _sidebar.md

📝 开始更新顶部导航栏...
✅ 顶部导航栏已更新: _navbar.md

============================================================
✅ 所有导航文件已成功更新！

📝 下一步:
  1. 检查生成的 _sidebar.md 和 _navbar.md
  2. 运行 ./start.sh 预览效果
  3. 提交更改: git add . && git commit -m '更新导航' && git push
============================================================
```

---

## 🔧 高级用法

### 1. 添加新的一级分类

假设你想添加"前端开发"分类：

```bash
# 1. 创建目录
mkdir -p "doc/前端开发"

# 2. 添加文章
vim "doc/前端开发/Vue3实战.md"
vim "doc/前端开发/React入门.md"

# 3. 更新图标映射（可选）
# 编辑 update_nav.py，在 CATEGORY_ICONS 中添加：
# '前端开发': '💻',

# 4. 运行脚本
python3 update_nav.py

# 5. 更新 _navbar.md 中的描述（如果需要）
```

### 2. 修改排除规则

如果你想让 `README.md` 也出现在侧边栏：

编辑 `update_nav.py`：

```python
# 修改前
EXCLUDE_FILES = {'README.md', '.DS_Store'}

# 修改后
EXCLUDE_FILES = {'.DS_Store'}  # 移除 README.md
```

### 3. 调整目录层级

脚本默认支持多级目录，会自动递归扫描。

如果你想限制层级深度，可以修改 `scan_directory` 函数。

---

## ⚠️ 注意事项

### 1. 文件命名规范

- ✅ **推荐**: `01Hadoop入门.md`、`Redis相关.md`
- ⚠️ **注意**: 文件名中的空格会被自动编码为 `%20`
- ❌ **避免**: 特殊字符如 `#`、`?`、`&` 等

### 2. 目录结构

```
doc/
├── 大数据书籍/
│   ├── Hadoop 权威指南/
│   │   ├── 01章节.md
│   │   └── assets/          # 图片资源
│   └── Kafka/
└── 烂笔头/
    ├── 文章.md
    └── assets/              # 图片资源
```

**重要**: 
- 所有笔记必须放在 `doc` 目录下
- 图片资源放在对应的 `assets` 文件夹
- `assets` 文件夹会被自动排除，不会出现在导航中

### 3. 执行权限

如果脚本无法执行：

```bash
chmod +x update_nav.py
chmod +x update_nav.sh
chmod +x start.sh
```

### 4. Python 版本

确保使用 Python 3.6 或更高版本：

```bash
python3 --version
```

---

## 🐛 常见问题

### Q1: 脚本运行后导航没有更新？

**A**: 
1. 检查是否在项目根目录运行脚本
2. 确认 `doc` 目录存在
3. 清除浏览器缓存后重新加载

### Q2: 中文文件名显示乱码？

**A**: 
1. 确保文件使用 UTF-8 编码
2. 检查终端是否支持 UTF-8

### Q3: 图片无法显示？

**A**: 
1. 确保图片在 `assets` 文件夹中
2. 使用相对路径引用: `![](assets/image.png)`
3. 图片文件名避免使用中文和空格

### Q4: Shell 脚本在 Windows 上无法运行？

**A**: 
1. 使用 Git Bash 或 WSL
2. 或者使用 Python 版本: `python update_nav.py`

### Q5: 想要自定义侧边栏样式？

**A**: 
1. 运行脚本生成基础导航
2. 手动编辑 `_sidebar.md` 进行微调
3. 下次运行脚本会覆盖，建议备份自定义内容

---

## 💡 最佳实践

### 1. 养成习惯

每次添加新文章后立即运行：

```bash
python3 update_nav.py && ./start.sh
```

### 2. Git 钩子自动化

创建 `.git/hooks/pre-commit`：

```bash
#!/bin/bash
python3 update_nav.py
git add _sidebar.md _navbar.md
```

这样每次提交前会自动更新导航。

### 3. 使用别名

在 `~/.bashrc` 或 `~/.zshrc` 中添加：

```bash
alias update-nav='cd ~/path/to/wjh9102.github.io && python3 update_nav.py'
alias preview='cd ~/path/to/wjh9102.github.io && ./start.sh'
```

然后可以在任何目录运行：

```bash
update-nav
preview
```

---

## 📚 相关文档

- [快速开始.md](快速开始.md) - 快速上手指南
- [DEPLOY.md](DEPLOY.md) - 部署说明
- [PROJECT_INFO.md](PROJECT_INFO.md) - 项目配置详情

---

## 🎉 总结

使用这些脚本，你的工作流程将变得非常简单：

```bash
# 1. 写文章
vim doc/烂笔头/新文章.md

# 2. 更新导航
python3 update_nav.py

# 3. 预览
./start.sh

# 4. 提交
git add . && git commit -m "添加新文章" && git push
```

就是这么简单！✨

